---
layout: post
title:  "关于Python中\"__main__\""
date:   2019-7-13 23:00:00
categories: Python
tags: Python
excerpt: 关于Python中__name__这一变量的解释
mathjax: true
---

## 一、引言

Python程序中，我们常常能看到有如下这样的代码：

```python
if __name__ == '__main__':
```

这种代码似乎有点类似于C语言中的`main`函数，但python中却又有些不同。

## 二、程序入口

大多数编程语言需要一个程序入口，即C语言中的`main`函数。而python作为一门解释型语言，它会被从第一行开始解释运行，并不需要程序入口。同时，一个py文件可以同时作为单独的脚本文件来执行，也可以作为一个模块被import进其他python程序中，问题就在此时产生了，在作为模块时，有些内容我们并不希望它运行，那我们该如何做呢？

## 三、__name__变量

在Python中，`__name__`是一个内置字符型变量，也就是你无需声明，在python程序运行时就已经存在，它存储着当前模块的名字。  
如果`__name__`的值为`__main__`，那么就表示它作为一个单独的脚本运行，而不是以模块的形式插入到别的python脚本中运行。如果是，它的值将为这个模块的名字。

## 四、应用

知道了python中`__name__`的作用后，我们可以用它来实现一些特殊的功能。例如，当我们需要调试一个模块时，我们可以在模块中加入如下代码：

```python
if __name__ == '__main__':
    #this is the code to test
```

这样，如果我们单独运行这个模块，它会执行测试部分的代码，让程序员来检测该模块的正确性，以便于插入其他python脚本中。而当我们import进其他的python程序中时，由于`__name__`不再为`__main__`，这部分代码也就不会再执行，测试的代码也就不会对插入的程序产生影响。

## 五、写在最后

由于`__name__`变量有如此重要的作用，我们在程序中应当尽可能避免出现对该变量进行修改的情况，否则整个程序，乃至将此作为模块插入的主程序也会出现严重问题。  
例如，如下的代码：

```python
__name__ = 'notmain'

#other code

if __name__ == '__main__':
    #...
```

就会出现程序无法进入if语句的情况，我们所需要的功能也就不能实现，而更严重的情况是下面这种：

```python
__name__ = '__main__'

#other code

if __name__ == '__main__':
    #...
```

这种代码会导致无论该程序是作为脚本运行还是模块插入主程序中，if后面的语句都会运行，那么本该在测试中运行的代码就会进入主程序中运行，带来不可预估的后果。
